---
title: "Crime in 2018"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(flexdashboard)
library(tidyverse)
library(viridis)
library(crimedata)
library(leaflet.extras)
library(plotly)
```

```{r}
homicide_data = get_crime_data(years = 2018, cities = "Chicago")
```


Column {data-width=600}
-----------------------------------------------------------------------

### Heat Map of Crime in Chicago

```{r}
leaflet(homicide_data) %>%
  addTiles() %>%
  addHeatmap(lng = ~longitude, lat = ~latitude, radius = 8)
```

Column {data-width=400}
-----------------------------------------------------------------------

### Marked Map of Crime in Chicago

```{r}
leaflet(homicide_data) %>% 
  addTiles() %>% 
  addMarkers(
    ~longitude, ~latitude,
    popup = ~ offense_type)
```

### Crime Type in Chicago

```{r}
homicide_data %>% 
  group_by(offense_type) %>% 
  summarize(
    n = n()
  ) %>% 
  plot_ly(x = ~offense_type, y = ~n, type = "bar") %>% 
  layout(
    xaxis = list(title = "Offense Type",  tickangle = 45),
    yaxis = list(title = "Count")
  )
```

