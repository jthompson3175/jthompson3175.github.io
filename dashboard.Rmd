---
title: "NYC Restaurant Inspection Data"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(flexdashboard)
library(tidyverse)
library(viridis)
library(p8105.datasets)

library(plotly)
```

```{r}
data(rest_inspec)

rest_clean = 
  mutate(rest_inspec, grade_date = as.character(grade_date)) %>% 
  separate(col = grade_date, into = c("year", "month", "day"), sep="-") %>% 
  select(-building, -camis, -street, -zipcode, -phone, -record_date, -violation_code) %>% 
  drop_na(grade, year) %>%
  filter(grade == "A" | grade == "B" | grade == "C", boro != "Missing", year != "2012")
```


Column {data-width=650}
-----------------------------------------------------------------------

### Proportion of Restaurants with Grade "A" by Year

```{r}
rest_clean %>% 
  mutate(
    is_a = (grade == "A")
  ) %>% 
  group_by(boro, year) %>% 
  summarize(
    proportion_a = sum(is_a)/n()
  ) %>% plot_ly(x = ~year, y = ~proportion_a, type = "scatter", mode = "lines+markers",
    color = ~boro, alpha = 0.5)
```

Column {data-width=350}
-----------------------------------------------------------------------

### Count of Restaurant Grade by Borough

```{r}
rest_clean %>% 
  group_by(grade, boro) %>% 
  summarize(
    n = n()
  ) %>% 
  plot_ly(x = ~boro, y = ~n, type = "bar",
          color = ~grade, alpha = 0.5)
```

### Distribution of Score by Borough

```{r}
rest_clean %>% 
  plot_ly(x = ~boro, y = ~score, type = "violin")
```

